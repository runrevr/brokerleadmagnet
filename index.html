<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brokerage Intelligence Assessment Platform</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Manrope:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'spruce': '#264E36',
                        'river-stone': '#78909C',
                        'sea-glass': '#9DBFBF',
                        'mist': '#F5F7F7',
                        'storm-gray': '#37474F',
                        'fern': '#607D3B',
                        'bark-brown': '#6F4E37',
                        'signal-red': '#CC0000',
                        'amber': '#F59E0B'
                    },
                    fontFamily: {
                        'bebas': ['Bebas Neue', 'sans-serif'],
                        'manrope': ['Manrope', 'sans-serif'],
                        'jetbrains': ['JetBrains Mono', 'monospace']
                    }
                }
            }
        }
    </script>
    <style>
        /* Print-specific styles for PDF generation */
        @media print {
            /* Hide elements that shouldn't appear in PDF */
            .no-print {
                display: none !important;
            }

            /* Reset backgrounds for printing */
            body {
                background: white !important;
            }

            /* Remove shadows for cleaner print */
            .shadow-lg, .shadow, .shadow-sm {
                box-shadow: none !important;
            }

            /* Ensure charts render properly */
            canvas {
                max-width: 100%;
                page-break-inside: avoid;
            }

            /* Page breaks */
            .print-break {
                page-break-before: always;
            }

            .print-avoid-break {
                page-break-inside: avoid;
            }

            /* Adjust margins for print */
            @page {
                margin: 0.5in;
            }

            /* Ensure colored backgrounds print */
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
        }
        /* Base typography */
        body {
            font-family: 'Manrope', sans-serif;
        }

        h1, h2 {
            font-family: 'Bebas Neue', sans-serif;
            letter-spacing: 0.02em;
        }

        h3, h4, h5 {
            font-family: 'Manrope', sans-serif;
        }

        .font-mono, .score-display {
            font-family: 'JetBrains Mono', monospace;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Transaction Failure Risk Assessment Questions
        // One question per slide with card-based options
        const assessmentQuestions = {
            companyInfo: {
                title: "Let's Get Started",
                questions: [
                    {
                        id: "company_name",
                        label: "What's Your Brokerage Name?",
                        type: "text",
                        required: true
                    }
                ]
            },
            agentCount: {
                title: "Company Size",
                questions: [
                    {
                        id: "agent_count",
                        label: "How Many Agents Are in Your Brokerage?",
                        type: "cards",
                        required: true,
                        options: [
                            { value: "1-10", icon: "user", label: "1-10 Agents", description: "Small team" },
                            { value: "11-25", icon: "users", label: "11-25 Agents", description: "Growing team" },
                            { value: "26-50", icon: "users", label: "26-50 Agents", description: "Mid-size brokerage" },
                            { value: "51-100", icon: "chart-mid-high", label: "51-100 Agents", description: "Large brokerage" },
                            { value: "100+", icon: "chart-high", label: "100+ Agents", description: "Enterprise" }
                        ]
                    }
                ]
            },
            monthlyDeals: {
                title: "Transaction Volume",
                questions: [
                    {
                        id: "monthly_deals",
                        label: "What's Your Average Monthly Transaction Volume?",
                        type: "cards",
                        required: true,
                        options: [
                            { value: "1-10", icon: "document-text", label: "1-10/month", description: "Getting started" },
                            { value: "11-20", icon: "document-text", label: "11-20/month", description: "Steady flow" },
                            { value: "21-50", icon: "clipboard", label: "21-50/month", description: "Active pipeline" },
                            { value: "51-100", icon: "clipboard", label: "51-100/month", description: "High volume" },
                            { value: "101-200", icon: "database", label: "101-200/month", description: "Very high volume" },
                            { value: "200+", icon: "database", label: "200+/month", description: "Enterprise volume" }
                        ]
                    }
                ]
            },
            location: {
                title: "Your Market",
                questions: [
                    {
                        id: "location",
                        label: "What's Your Primary Market/City?",
                        type: "text",
                        required: true
                    }
                ]
            },
            transactionSystem: {
                title: "Current Systems",
                questions: [
                    {
                        id: "transaction_system",
                        label: "What Transaction Management System Do You Use?",
                        type: "cards",
                        required: true,
                        options: [
                            { value: "SkySlope", icon: "computer", label: "SkySlope", description: "Transaction management" },
                            { value: "LoneWolf", icon: "computer", label: "LoneWolf", description: "Back office & TC" },
                            { value: "Dotloop", icon: "computer", label: "Dotloop", description: "Transaction platform" },
                            { value: "Other", icon: "clipboard", label: "Other System", description: "Different platform" },
                            { value: "None", icon: "question", label: "None", description: "No formal system" }
                        ]
                    }
                ]
            },
            dealsFallenThrough: {
                title: "Deal Failure Reality",
                questions: [
                    {
                        id: "deals_fallen_through",
                        label: "In the Last 12 Months, How Many Deals Fell Through AFTER Being Under Contract?",
                        type: "cards",
                        required: true,
                        options: [
                            { value: "We don't track this", icon: "question", label: "Don't Track", description: "No data available" },
                            { value: "0 deals", icon: "check-circle", label: "0 Deals", description: "Perfect record" },
                            { value: "1-3 deals", icon: "alert-medium", label: "1-3 Deals", description: "Minor losses" },
                            { value: "4-8 deals", icon: "alert-medium", label: "4-8 Deals", description: "Moderate losses" },
                            { value: "9-15 deals", icon: "alert-high", label: "9-15 Deals", description: "Significant losses" },
                            { value: "15+ deals", icon: "alert-high", label: "15+ Deals", description: "Critical issue" }
                        ],
                        scoring: { "We don't track this": 0, "0 deals": 5, "1-3 deals": 20, "4-8 deals": 15, "9-15 deals": 10, "15+ deals": 5 }
                    }
                ]
            },
            failedDealCauses: {
                title: "Deal Failure Analysis",
                questions: [
                    {
                        id: "failed_deal_causes",
                        label: "What Percentage of Failed Deals Were Due to Missed Deadlines, Inspection Issues, or Document Problems?",
                        type: "cards",
                        required: true,
                        options: [
                            { value: "Don't know/Can't say", icon: "question", label: "Don't Know", description: "Can't determine" },
                            { value: "Less than 25%", icon: "chart-low", label: "Less than 25%", description: "Rare cause" },
                            { value: "25-50%", icon: "chart-mid-low", label: "25-50%", description: "Some failures" },
                            { value: "50-75%", icon: "chart-mid-high", label: "50-75%", description: "Major cause" },
                            { value: "75-100%", icon: "chart-high", label: "75-100%", description: "Primary cause" }
                        ],
                        scoring: { "Don't know/Can't say": 0, "Less than 25%": 20, "25-50%": 15, "50-75%": 10, "75-100%": 5 }
                    }
                ]
            },
            lostCommissionValue: {
                title: "Financial Impact",
                questions: [
                    {
                        id: "lost_commission_value",
                        label: "What's the Approximate Dollar Value of Lost Commissions from Failed Deals in the Last 12 Months?",
                        type: "cards",
                        required: true,
                        options: [
                            { value: "Haven't calculated", icon: "question", label: "Haven't Calculated", description: "Unknown amount" },
                            { value: "Under $50K", icon: "chart-low", label: "Under $50K", description: "Minimal loss" },
                            { value: "$50K-$150K", icon: "chart-mid-low", label: "$50K-$150K", description: "Moderate loss" },
                            { value: "$150K-$300K", icon: "chart-mid-high", label: "$150K-$300K", description: "Significant loss" },
                            { value: "$300K-$500K", icon: "chart-high", label: "$300K-$500K", description: "Major loss" },
                            { value: "Over $500K", icon: "alert-high", label: "Over $500K", description: "Critical loss" }
                        ],
                        scoring: { "Haven't calculated": 0, "Under $50K": 25, "$50K-$150K": 20, "$150K-$300K": 15, "$300K-$500K": 10, "Over $500K": 5 }
                    }
                ]
            },
            inspectionDeadlinesVisibility: {
                title: "Deadline Visibility",
                questions: [
                    {
                        id: "inspection_deadlines_visibility",
                        label: "Right Now, Without Looking Anything Up, How Many Agents Have Inspection Deadlines in the Next 7 Days?",
                        type: "cards",
                        required: true,
                        options: [
                            { value: "Can tell you the exact number", icon: "check-circle", label: "Know Exactly", description: "Complete visibility" },
                            { value: "Could find out in under 5 minutes", icon: "clock", label: "Under 5 Minutes", description: "Quick access" },
                            { value: "Would need to ask TCs or agents", icon: "users", label: "Ask TCs/Agents", description: "Need to inquire" },
                            { value: "Would take 30+ minutes to compile", icon: "clock-slow", label: "30+ Minutes", description: "Time-consuming" },
                            { value: "Don't know and can't easily find out", icon: "question", label: "Don't Know", description: "No visibility" }
                        ],
                        scoring: { "Can tell you the exact number": 35, "Could find out in under 5 minutes": 25, "Would need to ask TCs or agents": 15, "Would take 30+ minutes to compile": 5, "Don't know and can't easily find out": 0 }
                    }
                ]
            },
            atRiskDeals: {
                title: "Risk Awareness",
                questions: [
                    {
                        id: "at_risk_deals",
                        label: "How Many Deals Closing THIS MONTH Could Be at Risk Due to Financing Delays or Appraisal Issues?",
                        type: "cards",
                        required: true,
                        options: [
                            { value: "Can tell you exactly which deals and why", icon: "check-circle", label: "Know Exactly", description: "Full awareness" },
                            { value: "Could find out with some calls/research", icon: "phone", label: "Some Research", description: "Can discover" },
                            { value: "Would need to ask each agent", icon: "users", label: "Ask Each Agent", description: "Distributed info" },
                            { value: "No way to know until problems surface", icon: "question", label: "No Way to Know", description: "Blind spot" }
                        ],
                        scoring: { "Can tell you exactly which deals and why": 35, "Could find out with some calls/research": 20, "Would need to ask each agent": 10, "No way to know until problems surface": 0 }
                    }
                ]
            },
            addendumDeadlineHandling: {
                title: "Deadline Management",
                questions: [
                    {
                        id: "addendum_deadline_handling",
                        label: "When an Addendum Changes a Closing Date, What Happens to All Related Deadlines?",
                        type: "cards",
                        required: true,
                        options: [
                            { value: "System automatically recalculates everything", icon: "robot", label: "Auto-Recalculates", description: "System handles it" },
                            { value: "TC manually updates all dependent dates", icon: "clipboard", label: "TC Updates Manually", description: "Manual process" },
                            { value: "Agent is responsible for catching it", icon: "user", label: "Agent Responsible", description: "On the agent" },
                            { value: "We hope everyone notices and adjusts", icon: "question", label: "Hope for the Best", description: "No formal process" },
                            { value: "Usually gets missed until there's a problem", icon: "alert-high", label: "Usually Missed", description: "Common issue" }
                        ],
                        scoring: { "System automatically recalculates everything": 30, "TC manually updates all dependent dates": 20, "Agent is responsible for catching it": 10, "We hope everyone notices and adjusts": 5, "Usually gets missed until there's a problem": 0 }
                    }
                ]
            },
            dateExtractionTime: {
                title: "Document Processing",
                questions: [
                    {
                        id: "date_extraction_time",
                        label: "When a TC Uploads a Purchase Agreement, How Long Until All Critical Dates Are in Your Tracking System?",
                        type: "cards",
                        required: true,
                        options: [
                            { value: "Extracted automatically in under 30 seconds", icon: "robot", label: "Under 30 Seconds", description: "Automatic extraction" },
                            { value: "TC enters manually within same day", icon: "clock", label: "Same Day Manual", description: "TC enters" },
                            { value: "Agent enters when they get around to it", icon: "clock-slow", label: "When Agent Can", description: "Variable timing" },
                            { value: "We don't systematically extract all dates", icon: "question", label: "Not Systematic", description: "Ad hoc process" },
                            { value: "What tracking system?", icon: "alert-high", label: "No System", description: "No tracking" }
                        ],
                        scoring: { "Extracted automatically in under 30 seconds": 35, "TC enters manually within same day": 20, "Agent enters when they get around to it": 10, "We don't systematically extract all dates": 5, "What tracking system?": 0 }
                    }
                ]
            },
            inspectionDeadlineCheck: {
                title: "Deadline Validation",
                questions: [
                    {
                        id: "inspection_deadline_check",
                        label: "How Do You Know If an Inspection Deadline Is Too Short for Your Market?",
                        type: "cards",
                        required: true,
                        options: [
                            { value: "System compares to our standards and flags it", icon: "robot", label: "System Flags It", description: "Automated alerts" },
                            { value: "Experienced TC/broker notices during review", icon: "user", label: "TC/Broker Notices", description: "Human review" },
                            { value: "We realize it during inspection period when time is tight", icon: "clock-alert", label: "Realize Too Late", description: "During crunch" },
                            { value: "We don't proactively check this", icon: "question", label: "Don't Check", description: "No process" }
                        ],
                        scoring: { "System compares to our standards and flags it": 35, "Experienced TC/broker notices during review": 20, "We realize it during inspection period when time is tight": 10, "We don't proactively check this": 0 }
                    }
                ]
            },
            documentConflictDetection: {
                title: "Document Intelligence",
                questions: [
                    {
                        id: "document_conflict_detection",
                        label: "When HOA Documents Contradict the Purchase Agreement, How Do You Catch It?",
                        type: "cards",
                        required: true,
                        options: [
                            { value: "AI cross-references all transaction documents automatically", icon: "robot", label: "AI Cross-References", description: "Automatic detection" },
                            { value: "TC manually reviews for conflicts", icon: "document-search", label: "TC Manual Review", description: "Human review" },
                            { value: "Hoping agent notices during their review", icon: "user", label: "Hope Agent Notices", description: "Depends on agent" },
                            { value: "Usually only catch it if client asks or title finds it", icon: "question", label: "Catch It Later", description: "Reactive" },
                            { value: "We've had deals fall apart from this", icon: "alert-high", label: "Deals Have Failed", description: "Known problem" }
                        ],
                        scoring: { "AI cross-references all transaction documents automatically": 35, "TC manually reviews for conflicts": 20, "Hoping agent notices during their review": 10, "Usually only catch it if client asks or title finds it": 5, "We've had deals fall apart from this": 0 }
                    }
                ]
            },
            afterHoursPolicyAccess: {
                title: "Agent Knowledge Access",
                questions: [
                    {
                        id: "after_hours_policy_access",
                        label: "At 11 PM on a Saturday, Can Your Agents Find Your Brokerage Policies on Dual Agency, Commission Splits, or Required Forms?",
                        type: "cards",
                        required: true,
                        options: [
                            { value: "Yes, AI assistant trained on our docs, available 24/7", icon: "robot", label: "AI Assistant 24/7", description: "Always available" },
                            { value: "Yes, searchable knowledge base", icon: "database", label: "Knowledge Base", description: "Searchable docs" },
                            { value: "They'd text/email someone and wait for response", icon: "phone", label: "Text/Email Someone", description: "Wait for response" },
                            { value: "They'd have to wait until Monday to ask", icon: "clock", label: "Wait Until Monday", description: "Business hours only" },
                            { value: "They'd probably just guess based on what they remember", icon: "question", label: "Guess/Remember", description: "No reliable access" }
                        ],
                        scoring: { "Yes, AI assistant trained on our docs, available 24/7": 35, "Yes, searchable knowledge base": 25, "They'd text/email someone and wait for response": 15, "They'd have to wait until Monday to ask": 5, "They'd probably just guess based on what they remember": 0 }
                    }
                ]
            },
            agentConsistency: {
                title: "Process Consistency",
                questions: [
                    {
                        id: "agent_consistency",
                        label: "How Many Different Ways Do Your Agents Handle the Same Situation (e.g., Dual Agency)?",
                        type: "cards",
                        required: true,
                        options: [
                            { value: "One consistent way - we have documented standards", icon: "document-check", label: "One Consistent Way", description: "Documented standards" },
                            { value: "Mostly consistent with minor variations", icon: "clipboard", label: "Mostly Consistent", description: "Minor variations" },
                            { value: "Each experienced agent has their own approach", icon: "users", label: "Own Approach", description: "Varies by agent" },
                            { value: "New agents copy whoever trained them", icon: "user", label: "Copy Trainer", description: "Informal learning" },
                            { value: "Wide variation - \"every agent does it differently\"", icon: "question", label: "Wide Variation", description: "No consistency" }
                        ],
                        scoring: { "One consistent way - we have documented standards": 30, "Mostly consistent with minor variations": 20, "Each experienced agent has their own approach": 10, "New agents copy whoever trained them": 5, "Wide variation - \"every agent does it differently\"": 0 }
                    }
                ]
            },
            policyUpdateCompliance: {
                title: "Policy Compliance",
                questions: [
                    {
                        id: "policy_update_compliance",
                        label: "When You Update a Brokerage Policy, How Do You Ensure Compliance?",
                        type: "cards",
                        required: true,
                        options: [
                            { value: "System requires acknowledgment, tracks who's read it, tests understanding", icon: "shield-check", label: "System Tracks", description: "Full tracking & testing" },
                            { value: "Email to all agents with tracking", icon: "mail", label: "Email with Tracking", description: "Track opens" },
                            { value: "Announce in meeting, hope they remember", icon: "users", label: "Meeting Announcement", description: "Hope they remember" },
                            { value: "Post to shared drive, assume they'll see it", icon: "document-text", label: "Post to Drive", description: "Assume they'll see" },
                            { value: "Tell people informally as it comes up", icon: "chat", label: "Informal", description: "Ad hoc communication" }
                        ],
                        scoring: { "System requires acknowledgment, tracks who's read it, tests understanding": 35, "Email to all agents with tracking": 20, "Announce in meeting, hope they remember": 10, "Post to shared drive, assume they'll see it": 5, "Tell people informally as it comes up": 0 }
                    }
                ]
            },
            afterHoursClientSupport: {
                title: "Client Support",
                questions: [
                    {
                        id: "after_hours_client_support",
                        label: "How Do Your Clients Get Answers to Transaction Questions at 10 PM on a Sunday?",
                        type: "cards",
                        required: true,
                        options: [
                            { value: "AI chatbot with their specific transaction documents", icon: "robot", label: "AI Chatbot", description: "24/7 with their docs" },
                            { value: "Agent responds to texts/calls when available", icon: "phone", label: "Agent When Available", description: "Best effort response" },
                            { value: "They wait until Monday morning", icon: "clock", label: "Wait Until Monday", description: "Business hours only" },
                            { value: "They Google it and might get wrong answers", icon: "question", label: "Google It", description: "Risk of bad info" },
                            { value: "They get anxious and call multiple people", icon: "alert-medium", label: "Call Multiple People", description: "Creates stress" }
                        ],
                        scoring: { "AI chatbot with their specific transaction documents": 35, "Agent responds to texts/calls when available": 20, "They wait until Monday morning": 10, "They Google it and might get wrong answers": 5, "They get anxious and call multiple people": 0 }
                    }
                ]
            },
            clientDocumentUnderstanding: {
                title: "Client Comprehension",
                questions: [
                    {
                        id: "client_document_understanding",
                        label: "What Percentage of Your Clients Actually Understand What They're Signing?",
                        type: "cards",
                        required: true,
                        options: [
                            { value: "90%+ thanks to AI summaries and chatbot", icon: "check-circle", label: "90%+ (AI Helps)", description: "AI summaries & chat" },
                            { value: "75%+ through good agent explanation", icon: "user", label: "75%+ (Agent)", description: "Good explanation" },
                            { value: "50-75% - depends on agent and client", icon: "chart-mid-low", label: "50-75%", description: "Varies" },
                            { value: "25-50% - most just trust their agent", icon: "chart-low", label: "25-50%", description: "Trust-based" },
                            { value: "Under 25% - they mostly just sign", icon: "alert-high", label: "Under 25%", description: "Just sign" }
                        ],
                        scoring: { "90%+ thanks to AI summaries and chatbot": 35, "75%+ through good agent explanation": 25, "50-75% - depends on agent and client": 15, "25-50% - most just trust their agent": 8, "Under 25% - they mostly just sign": 0 }
                    }
                ]
            },
            closingDelays: {
                title: "Closing Performance",
                questions: [
                    {
                        id: "closing_delays",
                        label: "How Often Do Document/Paperwork Issues Delay Your Closings?",
                        type: "cards",
                        required: true,
                        options: [
                            { value: "Never - we catch everything early", icon: "check-circle", label: "Never", description: "Catch everything early" },
                            { value: "Rarely - maybe 1-2 times per year", icon: "clock", label: "Rarely (1-2/year)", description: "Occasional delays" },
                            { value: "Occasionally - 3-5 times per year", icon: "clock-alert", label: "Occasionally (3-5)", description: "Some delays" },
                            { value: "Regularly - 6-10 times per year", icon: "alert-medium", label: "Regularly (6-10)", description: "Frequent delays" },
                            { value: "Frequently - happens all the time", icon: "alert-high", label: "Frequently", description: "Constant issue" }
                        ],
                        scoring: { "Never - we catch everything early": 35, "Rarely - maybe 1-2 times per year": 25, "Occasionally - 3-5 times per year": 15, "Regularly - 6-10 times per year": 8, "Frequently - happens all the time": 0 }
                    }
                ]
            },
            eoClaimsHistory: {
                title: "E&O Risk Assessment",
                questions: [
                    {
                        id: "eo_claims_history",
                        label: "E&O Claims or Near-Misses in the Last 2 Years?",
                        type: "cards",
                        required: true,
                        options: [
                            { value: "0 claims, 0 near-misses", icon: "shield-check", label: "0 Claims, 0 Near-Misses", description: "Clean record" },
                            { value: "0 claims, 1-2 near-misses", icon: "shield", label: "0 Claims, 1-2 Near-Misses", description: "Some close calls" },
                            { value: "0 claims, 3+ near-misses", icon: "alert-medium", label: "0 Claims, 3+ Near-Misses", description: "Multiple close calls" },
                            { value: "1 claim", icon: "alert-high", label: "1 Claim", description: "One claim filed" },
                            { value: "2+ claims", icon: "alert-high", label: "2+ Claims", description: "Multiple claims" }
                        ],
                        scoring: { "0 claims, 0 near-misses": 34, "0 claims, 1-2 near-misses": 25, "0 claims, 3+ near-misses": 15, "1 claim": 8, "2+ claims": 0 }
                    }
                ]
            },
            liabilityRiskAwareness: {
                title: "Risk Visibility",
                questions: [
                    {
                        id: "liability_risk_awareness",
                        label: "Do You Know Which of Your Current Transactions Have the Highest Liability Risk?",
                        type: "cards",
                        required: true,
                        options: [
                            { value: "Yes - system scores risk and flags issues automatically", icon: "robot", label: "System Scores Risk", description: "Automatic flagging" },
                            { value: "Somewhat - experienced broker/TC flags concerning deals", icon: "user", label: "Broker/TC Flags", description: "Human judgment" },
                            { value: "Not really - we treat all deals the same", icon: "clipboard", label: "Treat All Same", description: "No differentiation" },
                            { value: "No - we only know when something goes wrong", icon: "question", label: "Know When Wrong", description: "Reactive only" }
                        ],
                        scoring: { "Yes - system scores risk and flags issues automatically": 33, "Somewhat - experienced broker/TC flags concerning deals": 20, "Not really - we treat all deals the same": 10, "No - we only know when something goes wrong": 0 }
                    }
                ]
            }
        };

        // Scoring calculation function
        const calculateScores = (responses) => {
            // Map questions to category groups for scoring
            const categoryMapping = {
                dealFailureReality: ['deals_fallen_through', 'failed_deal_causes', 'lost_commission_value'],
                deadlineVisibility: ['inspection_deadlines_visibility', 'at_risk_deals', 'addendum_deadline_handling'],
                documentIntelligence: ['date_extraction_time', 'inspection_deadline_check', 'document_conflict_detection'],
                agentKnowledge: ['after_hours_policy_access', 'agent_consistency', 'policy_update_compliance'],
                clientExperienceLiability: ['after_hours_client_support', 'client_document_understanding', 'closing_delays'],
                eoRiskProtection: ['eo_claims_history', 'liability_risk_awareness']
            };

            let scores = {
                dealFailureReality: 0,
                deadlineVisibility: 0,
                documentIntelligence: 0,
                agentKnowledge: 0,
                clientExperienceLiability: 0,
                eoRiskProtection: 0,
                overall: 0
            };

            // Calculate category scores by iterating through all questions
            Object.entries(assessmentQuestions).forEach(([categoryKey, data]) => {
                data.questions.forEach(question => {
                    if (question.scoring && responses[question.id]) {
                        const score = question.scoring[responses[question.id]] || 0;

                        // Find which category group this question belongs to
                        for (const [catGroup, questionIds] of Object.entries(categoryMapping)) {
                            if (questionIds.includes(question.id)) {
                                scores[catGroup] += score;
                                break;
                            }
                        }
                    }
                });
            });

            // Calculate overall score
            const totalScore = scores.dealFailureReality + scores.deadlineVisibility +
                              scores.documentIntelligence + scores.agentKnowledge +
                              scores.clientExperienceLiability + scores.eoRiskProtection;

            // Total possible: 512 points (45+100+105+100+95+67)
            scores.overall = Math.round((totalScore / 512) * 100);

            // Determine risk level based on new scoring framework
            if (scores.overall >= 88) {
                scores.riskLevel = "LEADER";
                scores.riskDescription = "Transaction Intelligence Leader";
            } else if (scores.overall >= 71) {
                scores.riskLevel = "MODERATE";
                scores.riskDescription = "Moderate Risk with Gaps";
            } else if (scores.overall >= 53) {
                scores.riskLevel = "HIGH";
                scores.riskDescription = "High Risk - Flying Blind";
            } else if (scores.overall >= 35) {
                scores.riskLevel = "CRITICAL";
                scores.riskDescription = "Critical Risk";
            } else {
                scores.riskLevel = "EXISTENTIAL";
                scores.riskDescription = "Existential Threat";
            }

            // Determine percentile
            if (scores.overall >= 88) scores.percentile = "Top 5%";
            else if (scores.overall >= 71) scores.percentile = "Top 25%";
            else if (scores.overall >= 53) scores.percentile = "Top 50%";
            else scores.percentile = "Bottom 50%";

            // Calculate estimated annual losses based on score
            if (scores.overall >= 88) {
                scores.estimatedLosses = "Under $50K";
            } else if (scores.overall >= 71) {
                scores.estimatedLosses = "$75K-$150K";
            } else if (scores.overall >= 53) {
                scores.estimatedLosses = "$150K-$300K+";
            } else if (scores.overall >= 35) {
                scores.estimatedLosses = "$300K+";
            } else {
                scores.estimatedLosses = "Significant financial exposure";
            }

            return scores;
        };

        // Landing Page Component (based on Figma design)
        const IntroView = ({ onStart }) => {
            return (
                <div className="bg-white">
                    {/* Hero Section - Full Width Background */}
                    <section className="relative bg-cover bg-center bg-no-repeat min-h-[600px] flex items-center justify-center" style={{backgroundImage: "url('/lead-magnet-header.png')"}}>
                        {/* Dark Gradient Overlay - Left to Right */}
                        <div className="absolute inset-0 bg-gradient-to-r from-black via-black/70 to-black/20"></div>

                        {/* Hero Content */}
                        <div className="relative z-10 max-w-4xl mx-auto text-center px-4 py-16">
                            {/* Small label at top */}
                            <div className="text-sm text-white/90 uppercase tracking-wider mb-6 font-manrope font-medium">
                                Hidden Risk Revealed
                            </div>

                            {/* Main Headline */}
                            <h1 className="text-4xl md:text-5xl lg:text-6xl font-bebas text-white mb-6 leading-tight">
                                THE 6-FIGURE MISTAKES MOST BROKERAGES MAKE{' '}
                                <span className="text-amber">(AND HOW THE TOP 10% AVOID THEM)</span>
                            </h1>

                            {/* Subheading */}
                            <p className="text-lg md:text-xl text-white/90 mb-10 max-w-2xl mx-auto font-manrope leading-relaxed">
                                Most brokerages don't realize how much hidden risk sits inside their transactions. Take this free 5-minute assessment to uncover blind spots in compliance, agent oversight, and deal flow—and see how your firm compares to top-performers nationwide.
                            </p>

                            {/* CTA Button */}
                            <button
                                onClick={onStart}
                                className="inline-flex items-center gap-2 text-white px-10 py-5 rounded-md font-manrope font-bold text-lg transition-all duration-200 transform hover:-translate-y-1 hover:scale-105"
                                style={{
                                    backgroundColor: '#607D3B',
                                    boxShadow: '0 4px 6px rgba(0, 0, 0, 0.3), 0 10px 25px rgba(96, 125, 59, 0.4)'
                                }}
                                onMouseEnter={(e) => {
                                    e.currentTarget.style.backgroundColor = '#4F6630';
                                    e.currentTarget.style.boxShadow = '0 6px 10px rgba(0, 0, 0, 0.4), 0 15px 35px rgba(79, 102, 48, 0.5)';
                                }}
                                onMouseLeave={(e) => {
                                    e.currentTarget.style.backgroundColor = '#607D3B';
                                    e.currentTarget.style.boxShadow = '0 4px 6px rgba(0, 0, 0, 0.3), 0 10px 25px rgba(96, 125, 59, 0.4)';
                                }}
                            >
                                <svg className="w-6 h-6" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"/>
                                    <path fillRule="evenodd" d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z" clipRule="evenodd"/>
                                </svg>
                                Get My Risk Score & Improvement Plan
                            </button>

                            {/* Credibility Line */}
                            <p className="text-sm text-white/70 mt-6 font-manrope italic">
                                Built by real estate professionals with deep understanding of transaction workflows used in platforms like SkySlope and LoneWolf.
                            </p>
                        </div>
                    </section>

                    {/* Find Your Hidden Vulnerabilities Section */}
                    <section className="py-16 px-4 bg-white">
                        <div className="max-w-6xl mx-auto">
                            <div className="text-center mb-16">
                                <h2 className="text-3xl md:text-4xl font-bebas text-gray-800 mb-6 uppercase tracking-wide">
                                    Uncover the Risk Areas That Cost Brokerages the Most
                                </h2>
                                <p className="text-gray-600 font-manrope max-w-xl mx-auto mb-8">
                                    Our assessment pinpoints where gaps in compliance, agent oversight, operations, and client experience are exposing your brokerage to preventable losses.
                                </p>
                            </div>

                            {/* 4 Cards Grid */}
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
                                {/* Card 1 */}
                                <div className="bg-white p-6 rounded-lg border border-gray-200 transition-all duration-300 hover:-translate-y-0.5 hover:border-spruce/50" style={{boxShadow: '0 4px 14px rgba(0,0,0,0.045)'}}>
                                    <div className="w-12 h-12 bg-spruce/10 rounded-lg flex items-center justify-center mb-4 transition-colors duration-300 hover:bg-spruce/20">
                                        <svg className="w-6 h-6 text-spruce" fill="currentColor" viewBox="0 0 20 20">
                                            <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"/>
                                            <path fillRule="evenodd" d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm9.707 5.707a1 1 0 00-1.414-1.414L9 12.586l-1.293-1.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd"/>
                                        </svg>
                                    </div>
                                    <h3 className="text-lg font-bold text-gray-800 mb-2 font-manrope">Deal Failure Reality</h3>
                                    <p className="text-sm text-gray-600 font-manrope leading-relaxed">
                                        How many deals are falling through? What's the real cost of failed transactions to your brokerage's bottom line?
                                    </p>
                                </div>

                                {/* Card 2 */}
                                <div className="bg-white p-6 rounded-lg border border-gray-200 transition-all duration-300 hover:-translate-y-0.5 hover:border-spruce/50" style={{boxShadow: '0 4px 14px rgba(0,0,0,0.045)'}}>
                                    <div className="w-12 h-12 bg-spruce/10 rounded-lg flex items-center justify-center mb-4 transition-colors duration-300 hover:bg-spruce/20">
                                        <svg className="w-6 h-6 text-spruce" fill="currentColor" viewBox="0 0 20 20">
                                            <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clipRule="evenodd"/>
                                        </svg>
                                    </div>
                                    <h3 className="text-lg font-bold text-gray-800 mb-2 font-manrope">Deadline Visibility</h3>
                                    <p className="text-sm text-gray-600 font-manrope leading-relaxed">
                                        Can you see all critical deadlines across your agents' deals? Missing one inspection deadline can kill a deal.
                                    </p>
                                </div>

                                {/* Card 3 */}
                                <div className="bg-white p-6 rounded-lg border border-gray-200 transition-all duration-300 hover:-translate-y-0.5 hover:border-spruce/50" style={{boxShadow: '0 4px 14px rgba(0,0,0,0.045)'}}>
                                    <div className="w-12 h-12 bg-spruce/10 rounded-lg flex items-center justify-center mb-4 transition-colors duration-300 hover:bg-spruce/20">
                                        <svg className="w-6 h-6 text-spruce" fill="currentColor" viewBox="0 0 20 20">
                                            <path fillRule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z" clipRule="evenodd"/>
                                        </svg>
                                    </div>
                                    <h3 className="text-lg font-bold text-gray-800 mb-2 font-manrope">Document Intelligence</h3>
                                    <p className="text-sm text-gray-600 font-manrope leading-relaxed">
                                        How quickly are critical dates extracted from contracts? Are conflicts between documents being caught early?
                                    </p>
                                </div>

                                {/* Card 4 */}
                                <div className="bg-white p-6 rounded-lg border border-gray-200 transition-all duration-300 hover:-translate-y-0.5 hover:border-spruce/50" style={{boxShadow: '0 4px 14px rgba(0,0,0,0.045)'}}>
                                    <div className="w-12 h-12 bg-spruce/10 rounded-lg flex items-center justify-center mb-4 transition-colors duration-300 hover:bg-spruce/20">
                                        <svg className="w-6 h-6 text-spruce" fill="currentColor" viewBox="0 0 20 20">
                                            <path fillRule="evenodd" d="M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd"/>
                                        </svg>
                                    </div>
                                    <h3 className="text-lg font-bold text-gray-800 mb-2 font-manrope">E&O Risk Protection</h3>
                                    <p className="text-sm text-gray-600 font-manrope leading-relaxed">
                                        Do you know which transactions carry the highest liability risk? Are you protected before problems surface?
                                    </p>
                                </div>
                            </div>
                        </div>
                    </section>

                    {/* Your Path to Secure Transactions */}
                    <section className="py-16 px-4" style={{backgroundColor: '#9DBFBF'}}>
                        <div className="max-w-6xl mx-auto">
                            <div className="text-center mb-8">
                                {/* Subtle dividing line above */}
                                <div className="w-24 h-px bg-gray-800/10 mx-auto mb-6"></div>

                                <h2 className="text-3xl md:text-4xl font-bebas text-gray-800 mb-3 uppercase tracking-wide">
                                    SEE EXACTLY WHERE YOUR RISKS ARE—AND HOW TO FIX THEM
                                </h2>
                                <p className="text-gray-600 font-manrope max-w-2xl mx-auto">
                                    In just a few minutes, you'll uncover hidden vulnerabilities inside your transactions and walk away with a personalized improvement plan.
                                </p>
                            </div>

                            {/* 3 Step Process */}
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
                                {/* Step 1 */}
                                <div className="text-center">
                                    <div
                                        className="w-16 h-16 text-white rounded-full flex items-center justify-center text-2xl font-bold font-manrope mx-auto mb-4 transition-all duration-300 cursor-pointer hover:-translate-y-1 hover:scale-105"
                                        style={{backgroundColor: '#607D3B', boxShadow: '0 4px 14px rgba(96, 125, 59, 0.3)'}}
                                    >
                                        1
                                    </div>
                                    <h3 className="text-xl font-bold text-gray-800 mb-3 font-manrope">Take the Assessment</h3>
                                    <p className="text-gray-600 font-manrope text-sm leading-relaxed">
                                        Answer questions about your brokerage's transaction workflow. It's fast, easy, and completely confidential.
                                    </p>
                                </div>

                                {/* Step 2 */}
                                <div className="text-center">
                                    <div
                                        className="w-16 h-16 text-white rounded-full flex items-center justify-center text-2xl font-bold font-manrope mx-auto mb-4 transition-all duration-300 cursor-pointer hover:-translate-y-1 hover:scale-105"
                                        style={{backgroundColor: '#607D3B', boxShadow: '0 4px 14px rgba(96, 125, 59, 0.3)'}}
                                    >
                                        2
                                    </div>
                                    <h3 className="text-xl font-bold text-gray-800 mb-3 font-manrope">Get Your Intelligence Score</h3>
                                    <p className="text-gray-600 font-manrope text-sm leading-relaxed">
                                        Instantly receive a personalized Brokerage Intelligence Score, plus a breakdown of your highest-risk areas.
                                    </p>
                                </div>

                                {/* Step 3 */}
                                <div className="text-center">
                                    <div
                                        className="w-16 h-16 text-white rounded-full flex items-center justify-center text-2xl font-bold font-manrope mx-auto mb-4 transition-all duration-300 cursor-pointer hover:-translate-y-1 hover:scale-105"
                                        style={{backgroundColor: '#607D3B', boxShadow: '0 4px 14px rgba(96, 125, 59, 0.3)'}}
                                    >
                                        3
                                    </div>
                                    <h3 className="text-xl font-bold text-gray-800 mb-3 font-manrope">Fix Your Exposure</h3>
                                    <p className="text-gray-600 font-manrope text-sm leading-relaxed">
                                        Get tailored recommendations and a roadmap to reduce risk, improve oversight, and streamline your operations.
                                    </p>
                                </div>
                            </div>
                        </div>
                    </section>

                    {/* Bottom CTA Section */}
                    <section className="py-16 px-4" style={{backgroundColor: '#F7F9FA'}}>
                        <div className="max-w-4xl mx-auto text-center rounded-xl p-8 md:p-12" style={{border: '1px solid #E2E8F0'}}>
                            <h2 className="text-4xl md:text-5xl font-bebas mb-4 uppercase tracking-wide" style={{color: '#1e3a5f'}}>
                                Stop Guessing, Start Assessing.
                            </h2>
                            <p className="text-lg mb-8 font-manrope max-w-2xl mx-auto" style={{color: '#475569'}}>
                                Turn transaction anxiety into a competitive advantage. Discover how to protect your reputation, save money, and close more deals with confidence.
                            </p>
                            <button
                                onClick={onStart}
                                className="inline-flex items-center gap-2 text-white px-10 py-5 rounded-md font-manrope font-bold text-lg transition-all duration-200 transform hover:-translate-y-1 hover:scale-105"
                                style={{
                                    backgroundColor: '#607D3B',
                                    boxShadow: '0 4px 6px rgba(0, 0, 0, 0.3), 0 10px 25px rgba(96, 125, 59, 0.4)'
                                }}
                                onMouseEnter={(e) => {
                                    e.currentTarget.style.backgroundColor = '#4F6630';
                                    e.currentTarget.style.boxShadow = '0 6px 10px rgba(0, 0, 0, 0.4), 0 15px 35px rgba(79, 102, 48, 0.5)';
                                }}
                                onMouseLeave={(e) => {
                                    e.currentTarget.style.backgroundColor = '#607D3B';
                                    e.currentTarget.style.boxShadow = '0 4px 6px rgba(0, 0, 0, 0.3), 0 10px 25px rgba(96, 125, 59, 0.4)';
                                }}
                            >
                                Find My Risk Profile Now
                            </button>
                        </div>
                    </section>
                </div>
            );
        };

        // Main App Component
        const BrokerageIntelligenceApp = () => {
            const [currentStep, setCurrentStep] = useState(-1);
            const [responses, setResponses] = useState({});
            const [scores, setScores] = useState(null);
            const [showReport, setShowReport] = useState(false);
            const [email, setEmail] = useState('');
            const [emailCaptured, setEmailCaptured] = useState(false);

            const categories = Object.keys(assessmentQuestions);
            const currentCategory = currentStep >= 0 ? categories[currentStep] : null;
            const currentQuestions = currentStep >= 0 ? assessmentQuestions[currentCategory] : null;
            const progress = currentStep >= 0 ? ((currentStep + 1) / categories.length) * 100 : 0;

            const handleInputChange = (questionId, value) => {
                setResponses(prev => ({
                    ...prev,
                    [questionId]: value
                }));
            };

            const handleNext = () => {
                if (currentStep < categories.length - 1) {
                    setCurrentStep(currentStep + 1);
                } else {
                    // Calculate scores and show report
                    const calculatedScores = calculateScores(responses);
                    setScores(calculatedScores);
                    setShowReport(true);
                }
            };

            const handlePrevious = () => {
                if (currentStep > 0) {
                    setCurrentStep(currentStep - 1);
                }
            };

            const isCurrentStepValid = () => {
                const questions = currentQuestions.questions;
                return questions.every(q => !q.required || responses[q.id]);
            };

            const handleEmailSubmit = async (e) => {
                e.preventDefault();

                try {
                    // Step 1: Save assessment to database
                    const assessmentData = {
                        companyInfo: {
                            company_name: responses.company_name,
                            agent_count: responses.agent_count,
                            monthly_deals: responses.monthly_deals,
                            location: responses.location
                        },
                        responses,
                        scores,
                        timestamp: new Date().toISOString()
                    };

                    const submitResponse = await fetch('/api/assessment-submit', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(assessmentData)
                    });

                    if (!submitResponse.ok) {
                        throw new Error('Failed to save assessment');
                    }

                    const submitResult = await submitResponse.json();
                    const assessmentId = submitResult.assessmentId;

                    console.log('✅ Assessment saved:', assessmentId);

                    // Step 2: Capture email and trigger ActiveCampaign
                    const emailData = {
                        email,
                        assessmentId,
                        reportData: {
                            companyName: responses.company_name,
                            brokerageSize: responses.agent_count,
                            city: responses.location,
                            overallScore: scores.overall,
                            riskLevel: scores.riskLevel,
                            monthlyTransactions: responses.monthly_deals
                        }
                    };

                    const emailResponse = await fetch('/api/email-capture', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(emailData)
                    });

                    if (!emailResponse.ok) {
                        throw new Error('Failed to capture email');
                    }

                    const emailResult = await emailResponse.json();
                    console.log('✅ Email captured:', emailResult);

                    // Store assessment ID and report URL for display
                    window.assessmentId = assessmentId;
                    window.reportUrl = `${window.location.origin}/report.html?id=${assessmentId}`;

                    setEmailCaptured(true);

                } catch (error) {
                    console.error('❌ Error submitting assessment:', error);
                    alert('There was an error saving your assessment. Please try again.');
                }
            };

            if (showReport) {
                return <ReportView
                    responses={responses}
                    scores={scores}
                    emailCaptured={emailCaptured}
                    email={email}
                    setEmail={setEmail}
                    handleEmailSubmit={handleEmailSubmit}
                />;
            }

            // Show intro view before assessment begins
            if (currentStep === -1) {
                return <IntroView onStart={() => setCurrentStep(0)} />;
            }

            // Icon component for cards
            const IconComponent = ({ icon }) => {
                const iconMap = {
                    user: <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />,
                    shield: <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />,
                    clipboard: <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />,
                    users: <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />,
                    question: <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />,
                    clock: <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />,
                    'clock-slow': <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />,
                    'clock-alert': <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />,
                    'document-check': <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />,
                    'document-search': <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />,
                    'document-text': <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />,
                    database: <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4" />,
                    mail: <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />,
                    phone: <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />,
                    chat: <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />,
                    computer: <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />,
                    'chart-low': <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2z" />,
                    'chart-mid-low': <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />,
                    'chart-mid-high': <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />,
                    'chart-high': <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />,
                    robot: <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z" />,
                    'alert-high': <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />,
                    'alert-medium': <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />,
                    'shield-check': <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />,
                    'check-circle': <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                };
                return (
                    <svg className="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        {iconMap[icon] || iconMap['question']}
                    </svg>
                );
            };

            return (
                <div className="min-h-screen bg-mist py-12 px-4">
                    {/* Progress Bar - Fixed at top */}
                    <div className="fixed top-0 left-0 right-0 h-1.5 bg-gray-200 z-50">
                        <div
                            className="h-full bg-fern transition-all duration-300 ease-out"
                            style={{ width: `${progress}%` }}
                        ></div>
                    </div>

                    <div className="max-w-4xl mx-auto">
                        {/* Small Header */}
                        <div className="text-center mb-6">
                            <p className="text-sm text-gray-600 font-manrope font-medium">Brokerage Intelligence Assessment</p>
                        </div>

                        {/* Main Card */}
                        <div className="bg-white rounded-2xl shadow-lg p-8 md:p-12">
                            {/* Eyebrow Label */}
                            <div className="text-center mb-6">
                                <p className="text-xs md:text-sm text-gray-400 font-manrope font-medium uppercase tracking-wider">
                                    {currentQuestions.title}
                                </p>
                            </div>

                            {/* Question - HERO */}
                            <div className="text-center mb-12">
                                <h1 className="text-3xl md:text-4xl lg:text-5xl text-gray-800 font-bebas text-center mb-4 uppercase tracking-wide leading-tight">
                                    {currentQuestions.questions[0].label}
                                </h1>
                            </div>

                            {/* Answer Area */}
                            <div className="max-w-3xl mx-auto mb-12">
                                {/* Text Input */}
                                {currentQuestions.questions[0].type === 'text' && (
                                    <div className="space-y-6">
                                        <input
                                            type="text"
                                            className="w-full px-6 py-4 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-fern focus:border-fern font-manrope text-lg text-gray-800 text-center"
                                            placeholder="Enter your answer..."
                                            value={responses[currentQuestions.questions[0].id] || ''}
                                            onChange={(e) => handleInputChange(currentQuestions.questions[0].id, e.target.value)}
                                            required={currentQuestions.questions[0].required}
                                        />
                                    </div>
                                )}

                                {/* Card Grid */}
                                {currentQuestions.questions[0].type === 'cards' && (
                                    <div className={`grid gap-4 max-w-2xl mx-auto ${currentQuestions.questions[0].options.length <= 4 ? 'grid-cols-2' : 'grid-cols-2 md:grid-cols-3'}`}>
                                        {currentQuestions.questions[0].options.map((option, index) => {
                                            const isSelected = responses[currentQuestions.questions[0].id] === option.value;
                                            return (
                                                <button
                                                    key={option.value}
                                                    onClick={() => handleInputChange(currentQuestions.questions[0].id, option.value)}
                                                    className={`group relative p-6 rounded-xl border-2 transition-all hover:shadow-md ${
                                                        isSelected
                                                            ? 'border-fern'
                                                            : 'border-sea-glass hover:border-river-stone'
                                                    }`}
                                                    style={isSelected ? {backgroundColor: 'rgba(96, 125, 59, 0.08)'} : {}}
                                                >
                                                    {/* Checkmark Circle */}
                                                    <div className="absolute top-4 right-4">
                                                        {isSelected ? (
                                                            <div className="w-6 h-6 rounded-full bg-fern flex items-center justify-center">
                                                                <svg className="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={3} d="M5 13l4 4L19 7" />
                                                                </svg>
                                                            </div>
                                                        ) : (
                                                            <div className="w-6 h-6 rounded-full border-2 border-sea-glass"></div>
                                                        )}
                                                    </div>

                                                    {/* Icon */}
                                                    <div className={`w-12 h-12 rounded-lg flex items-center justify-center mb-4 transition-colors ${
                                                        isSelected
                                                            ? 'bg-fern text-white'
                                                            : 'bg-transparent text-storm-gray group-hover:text-river-stone'
                                                    }`}>
                                                        <IconComponent icon={option.icon} />
                                                    </div>

                                                    {/* Label */}
                                                    <div className="text-left">
                                                        <h3 className="text-lg font-bold text-gray-800 mb-1 font-manrope">{option.label}</h3>
                                                        <p className="text-sm text-gray-600 font-manrope">{option.description}</p>
                                                    </div>
                                                </button>
                                            );
                                        })}
                                    </div>
                                )}
                            </div>

                            {/* Navigation Buttons */}
                            <div className="flex justify-between max-w-2xl mx-auto">
                                <button
                                    onClick={handlePrevious}
                                    disabled={currentStep === 0}
                                    className="px-6 py-3 bg-sea-glass/50 text-storm-gray font-manrope font-semibold rounded-lg hover:bg-sea-glass disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
                                >
                                    Previous
                                </button>
                                <button
                                    onClick={handleNext}
                                    disabled={!isCurrentStepValid()}
                                    className="px-8 py-3 bg-fern text-white font-manrope font-bold rounded-lg hover:bg-spruce disabled:opacity-50 disabled:cursor-not-allowed transition-colors"
                                >
                                    {currentStep === categories.length - 1 ? 'See Your Results' : 'Next'}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // Report Component
        const ReportView = ({ responses, scores, emailCaptured, email, setEmail, handleEmailSubmit }) => {
            const chartRef = useRef(null);
            const radarChartRef = useRef(null);

            useEffect(() => {
                // Draw gauge chart for overall score
                if (chartRef.current) {
                    const ctx = chartRef.current.getContext('2d');
                    new Chart(ctx, {
                        type: 'doughnut',
                        data: {
                            datasets: [{
                                data: [scores.overall, 100 - scores.overall],
                                backgroundColor: [
                                    scores.overall >= 85 ? '#607D3B' :  // Fern for LOW risk
                                    scores.overall >= 70 ? '#F59E0B' :  // Amber for MODERATE
                                    scores.overall >= 50 ? '#F59E0B' :  // Amber for HIGH
                                    '#CC0000',                           // Signal Red for CRITICAL
                                    '#9DBFBF'                            // Sea Glass for remainder
                                ],
                                borderWidth: 0
                            }]
                        },
                        options: {
                            circumference: 180,
                            rotation: 270,
                            cutout: '75%',
                            plugins: {
                                legend: { display: false },
                                tooltip: { enabled: false }
                            }
                        }
                    });
                }

                // Draw radar chart for category scores
                if (radarChartRef.current) {
                    const ctx = radarChartRef.current.getContext('2d');
                    new Chart(ctx, {
                        type: 'radar',
                        data: {
                            labels: [
                                'Deal Failure Reality',
                                'Deadline Visibility',
                                'Document Intelligence',
                                'Agent Knowledge',
                                'Client Experience',
                                'E&O Risk'
                            ],
                            datasets: [{
                                label: 'Your Score',
                                data: [
                                    scores.dealFailureReality,
                                    scores.deadlineVisibility,
                                    scores.documentIntelligence,
                                    scores.agentKnowledge,
                                    scores.clientExperienceLiability,
                                    scores.eoRiskProtection
                                ],
                                backgroundColor: 'rgba(120, 144, 156, 0.2)',  // River Stone
                                borderColor: 'rgb(120, 144, 156)',            // River Stone
                                pointBackgroundColor: 'rgb(120, 144, 156)',
                                pointBorderColor: '#fff',
                                pointHoverBackgroundColor: '#fff',
                                pointHoverBorderColor: 'rgb(120, 144, 156)'
                            }, {
                                label: 'Top 5% Benchmark',
                                data: [40, 95, 100, 95, 90, 65],
                                backgroundColor: 'rgba(96, 125, 59, 0.2)',    // Fern
                                borderColor: 'rgb(96, 125, 59)',              // Fern
                                pointBackgroundColor: 'rgb(96, 125, 59)',
                                pointBorderColor: '#fff',
                                pointHoverBackgroundColor: '#fff',
                                pointHoverBorderColor: 'rgb(96, 125, 59)'
                            }]
                        },
                        options: {
                            scales: {
                                r: {
                                    beginAtZero: true,
                                    max: 105
                                }
                            }
                        }
                    });
                }
            }, [scores]);

            // Identify top gaps
            const gaps = [
                { name: 'Deal Failure Reality', score: scores.dealFailureReality, max: 45 },
                { name: 'Deadline Visibility', score: scores.deadlineVisibility, max: 100 },
                { name: 'Document Intelligence', score: scores.documentIntelligence, max: 105 },
                { name: 'Agent Knowledge', score: scores.agentKnowledge, max: 100 },
                { name: 'Client Experience', score: scores.clientExperienceLiability, max: 95 },
                { name: 'E&O Risk', score: scores.eoRiskProtection, max: 67 }
            ].sort((a, b) => (a.score/a.max) - (b.score/b.max)).slice(0, 3);

            return (
                <div className="min-h-screen bg-mist py-8">
                    <div className="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
                        {/* Report Header */}
                        <div className="bg-white rounded-lg shadow-lg p-8 mb-6">
                            <div className="text-center mb-8">
                                <h1 className="text-4xl font-bebas text-spruce mb-2 tracking-wide">
                                    Brokerage Intelligence Report
                                </h1>
                                <p className="text-xl font-manrope font-semibold text-storm-gray">
                                    {responses.company_name || 'Your Brokerage'}
                                </p>
                            </div>

                            {/* Overall Score Section */}
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
                                <div className="text-center">
                                    <h2 className="text-2xl font-manrope font-bold text-storm-gray mb-4">Overall Score</h2>
                                    <div className="relative inline-block">
                                        <canvas ref={chartRef} width="250" height="150"></canvas>
                                        <div className="absolute inset-0 flex items-center justify-center mt-8">
                                            <div>
                                                <div className="text-5xl font-jetbrains font-bold text-spruce">{scores.overall}</div>
                                                <div className="text-sm font-manrope text-storm-gray">out of 100</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div className={`mt-4 inline-block px-4 py-2 rounded-full text-white font-manrope font-semibold ${
                                        scores.riskLevel === 'LEADER' ? 'bg-fern' :
                                        scores.riskLevel === 'MODERATE' ? 'bg-amber' :
                                        scores.riskLevel === 'HIGH' ? 'bg-amber' : 'bg-signal-red'
                                    }`}>
                                        {scores.riskDescription || scores.riskLevel}
                                    </div>
                                </div>

                                <div>
                                    <h2 className="text-2xl font-manrope font-bold text-storm-gray mb-4">Performance Breakdown</h2>
                                    <canvas ref={radarChartRef} width="300" height="300"></canvas>
                                </div>
                            </div>

                        </div>

                        <div className="bg-white rounded-lg shadow-lg p-8 mb-6 border-2 border-signal-red">
                            <div className="text-center">
                                <div className="text-5xl mb-4">⚠️</div>
                                <h2 className="text-3xl font-bebas text-signal-red mb-4 tracking-wide">
                                    We Identified {gaps.length} Critical Operational Gaps
                                </h2>
                                <p className="text-xl font-manrope text-storm-gray mb-2">
                                    These inefficiencies are costing your brokerage an estimated{' '}
                                    <span className="font-bold text-signal-red font-jetbrains">
                                        ${scores.overall < 50 ? '127,000' : scores.overall < 70 ? '85,000' : '50,000'}+
                                    </span>{' '}
                                    per year in wasted time, missed deals, and liability exposure.
                                </p>
                                <p className="text-lg font-manrope text-storm-gray/80">
                                    Your complete report reveals exactly what's causing these gaps and how top brokerages have eliminated them.
                                </p>
                            </div>
                        </div>

                        {!emailCaptured ? (
                            <div className="bg-gradient-to-br from-spruce to-storm-gray rounded-lg shadow-2xl p-10 mb-6 text-white">
                                <div className="text-center max-w-4xl mx-auto">
                                    <h2 className="text-4xl md:text-5xl font-bebas mb-4 tracking-wide leading-tight">
                                        Want to See Your Full Report and How Top Brokerages Are Saving $50,000+/Year Using Technology?
                                    </h2>
                                    <p className="text-xl font-manrope mb-8 text-white/90">
                                        Discover the exact systems and capabilities your brokerage can integrate within the next 30-90 days to eliminate inefficiencies and scale profitably.
                                    </p>

                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8 text-left">
                                        <div className="bg-white/10 backdrop-blur rounded-lg p-5 border border-white/20">
                                            <div className="text-3xl mb-3">🎯</div>
                                            <h3 className="font-bold text-lg mb-2">Detailed Gap Analysis</h3>
                                            <p className="text-sm text-white/80">See exactly what's broken, why it matters, and the hidden costs</p>
                                        </div>
                                        <div className="bg-white/10 backdrop-blur rounded-lg p-5 border border-white/20">
                                            <div className="text-3xl mb-3">🗺️</div>
                                            <h3 className="font-bold text-lg mb-2">30-90 Day Roadmap</h3>
                                            <p className="text-sm text-white/80">Prioritized action plan with quick wins and transformational changes</p>
                                        </div>
                                        <div className="bg-white/10 backdrop-blur rounded-lg p-5 border border-white/20">
                                            <div className="text-3xl mb-3">💰</div>
                                            <h3 className="font-bold text-lg mb-2">ROI Projections</h3>
                                            <p className="text-sm text-white/80">Quantified savings based on your brokerage's actual operations</p>
                                        </div>
                                    </div>

                                    <form onSubmit={handleEmailSubmit} className="max-w-2xl mx-auto">
                                        <div className="bg-white rounded-lg p-2 shadow-xl flex flex-col sm:flex-row gap-2">
                                            <input
                                                type="email"
                                                value={email}
                                                onChange={(e) => setEmail(e.target.value)}
                                                placeholder="Enter your work email to unlock your full report"
                                                required
                                                className="flex-1 px-6 py-4 border-0 rounded-md focus:outline-none focus:ring-2 focus:ring-spruce font-manrope text-lg text-storm-gray"
                                            />
                                            <button
                                                type="submit"
                                                className="px-8 py-4 bg-signal-red text-white font-manrope font-bold rounded-md hover:bg-signal-red/90 transition-colors text-lg whitespace-nowrap shadow-lg"
                                            >
                                                Get My Full Report →
                                            </button>
                                        </div>
                                    </form>

                                    <div className="mt-6 flex flex-wrap items-center justify-center gap-6 text-sm text-white/80">
                                        <div className="flex items-center gap-2">
                                            <span>✓</span>
                                            <span>Instant access (no wait)</span>
                                        </div>
                                        <div className="flex items-center gap-2">
                                            <span>✓</span>
                                            <span>No credit card required</span>
                                        </div>
                                        <div className="flex items-center gap-2">
                                            <span>✓</span>
                                            <span>Based on 1,000+ assessments</span>
                                        </div>
                                        <div className="flex items-center gap-2">
                                            <span>🔒</span>
                                            <span>Your data is 100% secure</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        ) : (
                            <>
                                <div className="bg-fern/10 border-2 border-fern rounded-lg p-6">
                                    <h3 className="text-xl font-manrope font-bold mb-3 text-fern">✅ Report Saved!</h3>
                                    <p className="font-manrope text-storm-gray mb-4">
                                        Your assessment has been saved. Check your email for the complete intelligence report, or access it anytime using the link below.
                                    </p>

                                    {window.reportUrl && (
                                        <div className="bg-white border-2 border-sea-glass rounded-md p-4 mb-4">
                                            <p className="text-sm font-manrope font-medium text-storm-gray mb-2">Your Report URL:</p>
                                            <div className="flex items-center gap-2">
                                                <input
                                                    type="text"
                                                    value={window.reportUrl}
                                                    readOnly
                                                    className="flex-1 px-3 py-2 text-sm font-jetbrains bg-mist border-2 border-sea-glass rounded"
                                                />
                                                <button
                                                    onClick={() => {
                                                        navigator.clipboard.writeText(window.reportUrl);
                                                        alert('Report link copied to clipboard!');
                                                    }}
                                                    className="px-4 py-2 bg-storm-gray text-white text-sm font-manrope font-semibold rounded hover:bg-spruce transition-colors"
                                                >
                                                    Copy
                                                </button>
                                            </div>
                                        </div>
                                    )}

                                    <p className="text-sm font-manrope text-storm-gray mb-4">You'll also receive via email:</p>
                                    <ul className="list-disc list-inside font-manrope text-storm-gray text-sm mb-4">
                                        <li>Your full intelligence report with detailed insights</li>
                                        <li>Weekly industry insights and best practices</li>
                                        <li>Exclusive benchmarking updates</li>
                                    </ul>

                                    <div className="flex flex-wrap gap-3 no-print">
                                        {window.reportUrl && (
                                            <a
                                                href={window.reportUrl}
                                                target="_blank"
                                                rel="noopener noreferrer"
                                                className="px-6 py-2 bg-fern text-white font-manrope font-semibold rounded-md hover:bg-spruce flex items-center gap-2 transition-colors"
                                            >
                                                <span>📊</span> View Full Report
                                            </a>
                                        )}
                                        <button
                                            onClick={() => window.print()}
                                            className="px-6 py-2 bg-river-stone text-white font-manrope font-semibold rounded-md hover:bg-spruce flex items-center gap-2 transition-colors"
                                        >
                                            <span>📄</span> Download PDF
                                        </button>
                                        <button
                                            onClick={() => {
                                                const urlToCopy = window.reportUrl || window.location.href;
                                                navigator.clipboard.writeText(urlToCopy);
                                                alert('Report link copied! Share it with your team.');
                                            }}
                                            className="px-6 py-2 bg-storm-gray text-white font-manrope font-semibold rounded-md hover:bg-spruce flex items-center gap-2 transition-colors"
                                        >
                                            <span>🔗</span> Share Report
                                        </button>
                                    </div>
                                </div>
                                <div className="bg-white rounded-lg shadow-lg p-8 mb-6 print-break">
                                    <h2 className="text-2xl font-bebas text-spruce mb-6 tracking-wide">What the Top 5% Do Differently</h2>

                                    <div className="space-y-6">
                                    <div className="border-l-4 border-spruce pl-4">
                                        <h3 className="font-manrope font-bold text-lg mb-2 text-storm-gray">Transaction Oversight</h3>
                                        <p className="font-manrope text-storm-gray">
                                            Elite brokerages use AI-powered monitoring that reviews 100% of transactions in real-time,
                                            catching issues before they become problems. They maintain less than 1% error rate compared
                                            to the industry average of 15%.
                                        </p>
                                    </div>

                                    <div className="border-l-4 border-spruce pl-4">
                                        <h3 className="font-manrope font-bold text-lg mb-2 text-storm-gray">Knowledge Management</h3>
                                        <p className="font-manrope text-storm-gray">
                                            Top performers capture every lesson learned and encode it into their systems. New agents
                                            reach full productivity in 6 weeks versus the 6-month industry average.
                                        </p>
                                    </div>

                                    <div className="border-l-4 border-spruce pl-4">
                                        <h3 className="font-manrope font-bold text-lg mb-2 text-storm-gray">Client Experience</h3>
                                        <p className="font-manrope text-storm-gray">
                                            Leading brokerages provide 24/7 transaction visibility through AI chatbots and portals,
                                            resulting in 67% more referrals from satisfied clients.
                                        </p>
                                    </div>

                                    <div className="border-l-4 border-spruce pl-4">
                                        <h3 className="font-manrope font-bold text-lg mb-2 text-storm-gray">Risk Management</h3>
                                        <p className="font-manrope text-storm-gray">
                                            Elite firms predict and prevent issues with AI risk scoring, reducing E&O claims by 80%
                                            and saving an average of $45,000 annually in liability costs.
                                        </p>
                                    </div>
                                </div>

                                <div className="mt-8 bg-mist rounded-lg p-6">
                                    <h3 className="text-xl font-manrope font-bold text-storm-gray mb-4">Your 30-Day Quick Wins</h3>
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <div className="bg-white rounded p-4 border-2 border-sea-glass">
                                            <div className="font-manrope font-bold text-spruce mb-2">Week 1</div>
                                            <ul className="text-sm font-manrope text-storm-gray space-y-1">
                                                <li>• Implement deadline checklist</li>
                                                <li>• Create contract templates</li>
                                                <li>• Set up daily huddles</li>
                                            </ul>
                                        </div>
                                        <div className="bg-white rounded p-4 border-2 border-sea-glass">
                                            <div className="font-manrope font-bold text-spruce mb-2">Week 2-3</div>
                                            <ul className="text-sm font-manrope text-storm-gray space-y-1">
                                                <li>• Build knowledge library</li>
                                                <li>• Launch client portal</li>
                                                <li>• Train on best practices</li>
                                            </ul>
                                        </div>
                                        <div className="bg-white rounded p-4 border-2 border-sea-glass">
                                            <div className="font-manrope font-bold text-spruce mb-2">Week 4</div>
                                            <ul className="text-sm font-manrope text-storm-gray space-y-1">
                                                <li>• Measure improvements</li>
                                                <li>• Gather agent feedback</li>
                                                <li>• Plan automation phase</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>

                                <div className="mt-8 bg-spruce/10 rounded-lg p-6 border-2 border-spruce">
                                    <h3 className="text-xl font-manrope font-bold text-spruce mb-4">Potential ROI from Improvements</h3>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <p className="font-manrope text-storm-gray mb-2">Based on {responses.agent_count} agents and {responses.monthly_deals} monthly deals:</p>
                                            <ul className="space-y-2 font-manrope text-storm-gray">
                                                <li>• Time savings: <span className="font-semibold font-jetbrains">600 hours/month</span></li>
                                                <li>• Risk reduction: <span className="font-semibold font-jetbrains">$36,000/year saved</span></li>
                                                <li>• Deal saves: <span className="font-semibold font-jetbrains">5 deals/month recovered</span></li>
                                            </ul>
                                        </div>
                                        <div className="bg-white rounded p-4 text-center border-2 border-sea-glass">
                                            <div className="text-3xl font-jetbrains font-bold text-fern">$58,000</div>
                                            <div className="font-manrope text-storm-gray">Monthly Value Created</div>
                                            <div className="mt-2 text-2xl font-jetbrains font-bold text-spruce">38X ROI</div>
                                            <div className="font-manrope text-storm-gray">on Technology Investment</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            </>
                            )}
                    </div>
                </div>
            );
        };

        // Backend Integration Guide Component
        const IntegrationGuide = () => {
            return (
                <div className="max-w-4xl mx-auto p-8 bg-white rounded-lg shadow-lg mt-8">
                    <h2 className="text-2xl font-bold mb-6">Backend Integration Guide</h2>
                    
                    <div className="space-y-6">
                        <div className="border-l-4 border-blue-500 pl-4">
                            <h3 className="font-semibold text-lg mb-2">1. Database Schema (Supabase)</h3>
                            <pre className="bg-gray-100 p-4 rounded text-sm overflow-x-auto">
{`-- assessments table
CREATE TABLE assessments (
    id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    email TEXT NOT NULL,
    company_name TEXT,
    agent_count TEXT,
    monthly_deals TEXT,
    location TEXT,
    created_at TIMESTAMP DEFAULT NOW(),
    report_url TEXT
);

-- scores table
CREATE TABLE scores (
    id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    assessment_id UUID REFERENCES assessments(id),
    overall_score INTEGER,
    transaction_oversight_score INTEGER,
    knowledge_management_score INTEGER,
    client_experience_score INTEGER,
    risk_management_score INTEGER,
    risk_level TEXT,
    percentile TEXT
);

-- responses table
CREATE TABLE responses (
    id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    assessment_id UUID REFERENCES assessments(id),
    question_id TEXT,
    response_value TEXT
);

-- gaps table
CREATE TABLE gaps (
    id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    assessment_id UUID REFERENCES assessments(id),
    gap_category TEXT,
    gap_description TEXT,
    severity INTEGER
);`}
                            </pre>
                        </div>

                        <div className="border-l-4 border-green-500 pl-4">
                            <h3 className="font-semibold text-lg mb-2">2. ActiveCampaign Integration</h3>
                            <pre className="bg-gray-100 p-4 rounded text-sm overflow-x-auto">
{`// API endpoint to handle submission
app.post('/api/assessment/submit', async (req, res) => {
    const { email, responses, scores } = req.body;
    
    // Save to Supabase
    const { data: assessment } = await supabase
        .from('assessments')
        .insert({
            email,
            company_name: responses.company_name,
            agent_count: responses.agent_count,
            monthly_deals: responses.monthly_deals,
            location: responses.location
        })
        .select()
        .single();
    
    // Save scores
    await supabase
        .from('scores')
        .insert({
            assessment_id: assessment.id,
            ...scores
        });
    
    // Send to ActiveCampaign
    const acData = {
        contact: {
            email,
            fieldValues: [
                { field: 'COMPANY', value: responses.company_name },
                { field: 'SCORE', value: scores.overall },
                { field: 'RISK_LEVEL', value: scores.riskLevel },
                { field: 'AGENT_COUNT', value: responses.agent_count },
                { field: 'REPORT_URL', value: \`/report/\${assessment.id}\` }
            ]
        }
    };
    
    // Add tags based on score
    const tags = [];
    if (scores.overall >= 85) tags.push('Score: Elite');
    else if (scores.overall >= 70) tags.push('Score: Strong');
    else if (scores.overall >= 50) tags.push('Score: Average');
    else tags.push('Score: At-Risk');
    
    // Trigger automation
    await activeCampaign.createContact(acData);
    await activeCampaign.addTags(email, tags);
    await activeCampaign.triggerAutomation(email, 'assessment_followup');
    
    res.json({ success: true, reportId: assessment.id });
});`}
                            </pre>
                        </div>

                        <div className="border-l-4 border-purple-500 pl-4">
                            <h3 className="font-semibold text-lg mb-2">3. Report Generation Endpoint</h3>
                            <pre className="bg-gray-100 p-4 rounded text-sm overflow-x-auto">
{`app.get('/api/report/:id', async (req, res) => {
    const { id } = req.params;
    
    // Fetch assessment data
    const { data: assessment } = await supabase
        .from('assessments')
        .select('*, scores(*), responses(*), gaps(*)')
        .eq('id', id)
        .single();
    
    // Generate custom insights with GPT-4
    const insights = await generateInsights(assessment);
    
    // Return report data
    res.json({
        assessment,
        insights,
        benchmarks: getBenchmarkData(),
        recommendations: getRecommendations(assessment.scores)
    });
});`}
                            </pre>
                        </div>

                        <div className="border-l-4 border-yellow-500 pl-4">
                            <h3 className="font-semibold text-lg mb-2">4. Email Campaign Examples</h3>
                            <pre className="bg-gray-100 p-4 rounded text-sm overflow-x-auto">
{`// ActiveCampaign Automation Sequences

// Day 1: Score-specific email
Subject: "Your {{SCORE}}/100 Intelligence Score for {{COMPANY}}"
Body: Reference their specific gaps and provide one quick win

// Day 3: Biggest gap focus
Subject: "Why {{GAP_CATEGORY}} is Costing You Deals"
Body: Deep dive into their weakest area with solutions

// Day 7: Peer comparison
Subject: "How {{COMPANY}} Compares to Similar Brokerages"
Body: Show where they rank among peers

// Day 14: Risk alert
Subject: "{{RISK_LEVEL}} Risk Alert for {{COMPANY}}"
Body: Specific risks based on their score

// Day 21: Consultation offer
Subject: "Custom Roadmap for {{COMPANY}}'s Growth"
Body: Offer personalized consultation based on their data`}
                            </pre>
                        </div>
                    </div>
                </div>
            );
        };

        // Render the app
        ReactDOM.render(
            <div>
                <BrokerageIntelligenceApp />
                {/* Uncomment to see integration guide */}
                {/* <IntegrationGuide /> */}
            </div>,
            document.getElementById('root')
        );
    </script>
</body>
</html>